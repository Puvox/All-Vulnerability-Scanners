<?php


          exit ("Return back. This is demo project."); 




include_once(__DIR__.'/header.php');

$error=false;
$max_size_limit = 10 * 1000 * 1000;  

if (isset($_FILES['fileToUpload']))
{
  $file = $_FILES['fileToUpload'];
  /*   i.e. 
    [name] => example.zip
    [type] => application/zip
    [tmp_name] => /path/to/dir/tmp/php233A.tmp
    [error] => 0
    [size] => 100780
  */
  
  if ($file['size'] > $max_size_limit ){
    $error= "Filesize too big (max allowed: $max_size_limit )";
  }
  else if ( !$f->validate_zip($file['tmp_name']) ){
    $error= "incorrect file type. Upload .ZIP file.";
  }

  //success
  else{
   //..
  }
} 
?>
<div class="check_results">
  <?php
  if ($error) {
    echo "<h2>$error</h2>";
  }
  else{
    echo "<h2>Successfully uploaded!  Wait for results : ... </h2>";



    // The WAR start here.... 
    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ...
    $temp_destination = $f->temp_bin().'/'. $file['name'];
    move_uploaded_file($file['tmp_name'], $temp_destination);
    $temp_unzip_dir = dirname($temp_destination) .'/'. basename( preg_replace('/\.(.*)/',  rand(1,999999999), $temp_destination) );
    $f->unzip($temp_destination,$temp_unzip_dir);

    // scan $temp_unzip_dir with SCANNER, generate & save report, delete temp_dir and show results to user  

    // ...

    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ....codes ....
    // ....codes ....



  }
  ?>

</div>
<?php
include_once(__DIR__.'/footer.php');
?>